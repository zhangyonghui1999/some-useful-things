{"version":3,"sources":["webpack:///./src/views/excel/index.vue?f52c","webpack:///./src/views/excel/index.vue?a529","webpack:///src/views/excel/index.vue","webpack:///./src/views/excel/index.vue?1fd5","webpack:///./src/views/excel/index.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","staticRenderFns","name","data","tableData2","methods","handelUpload","console","log","file","handleChange","fileTemp","raw","fileList","importfxx","$message","type","message","handleRemove","obj","rABS","f","reader","FileReader","prototype","readAsBinaryString","wb","outdata","binary","onload","e","bytes","Uint8Array","result","length","byteLength","i","String","fromCharCode","XLSX","read","btoa","fixdata","utils","sheet_to_json","Sheets","SheetNames","da","map","IP","v","NAME","arr","push","_this","concat","readAsArrayBuffer","o","l","w","apply","slice","component"],"mappings":"kIAAA,yBAA+hB,EAAG,G,yCCAliB,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,WAClHC,EAAkB,G,sSC6BtB,GACEC,KAAM,QACNC,KAFF,WAGI,MAAO,CACLC,WAAY,KAGhBC,QAAS,CACPC,aADJ,SACA,GACMC,QAAQC,IAAI,iBAAkBC,IAGhCC,aALJ,SAKA,KACMf,KAAKgB,SAAWF,EAAKG,IACrBL,QAAQC,IAAI,OAAQC,GACpBF,QAAQC,IAAI,WAAYK,GAEpBlB,KAAKgB,UACPJ,QAAQC,IAAI,qBAAsBb,KAAKgB,UAEvChB,KAAKmB,UAAUnB,KAAKgB,WAQpBhB,KAAKoB,SAAS,CACZC,KAAM,UACNC,QAAS,YAKfC,aA5BJ,SA4BA,KACMvB,KAAKgB,SAAW,MAElBG,UA/BJ,SA+BA,GACM,IAAN,OAEMnB,KAAKc,KAAOU,EACZ,IAAIC,GAAO,EACPC,EAAI1B,KAAKc,KACTa,EAAS,IAAIC,WACjBhB,QAAQC,IAAI,SAAUc,GACtBC,WAAWC,UAAUC,mBAAqB,SAAUJ,GAClD,IAGIK,EACAC,EAJAC,EAAS,GACTR,GAAO,EAIPE,EAAS,IAAIC,WACjBhB,QAAQC,IAAI,WAAYc,GACxBA,EAAOO,OAAS,SAAUC,GACxB,IAAIC,EAAQ,IAAIC,WAAWV,EAAOW,QAClC1B,QAAQC,IAAIc,EAAOW,QAEnB,IADA,IAAIC,EAASH,EAAMI,WACVC,EAAI,EAAGA,EAAIF,EAAQE,IAC1BR,GAAUS,OAAOC,aAAaP,EAAMK,IAEtC7B,QAAQC,IAAI,SAAUoB,GACtB,IAAIW,EAAO,EAArB,QAEYb,EADEN,EACGmB,EAAKC,KAAKC,KAAK9C,KAAK+C,QAAQd,IAAU,CACzCZ,KAAM,WAGHuB,EAAKC,KAAKZ,EAAQ,CACrBZ,KAAM,WAGVW,EAAUY,EAAKI,MAAMC,cAAclB,EAAGmB,OAAOnB,EAAGoB,WAAW,KAC3DnD,KAAKoD,GAAK,OAApB,OAAoB,CAApB,GACU,IAAV,KACUpD,KAAKoD,GAAGC,KAAI,SAAtB,GACY,IAAZ,KACY7B,EAAI8B,GAAKC,EAAED,GACX9B,EAAIgC,KAAOD,EAAEC,KACbC,EAAIC,KAAKlC,MAGXZ,QAAQC,IAAI,MAAO4C,GAEnBE,EAAMlD,WAAakD,EAAMlD,WAAWmD,OAAOH,IAE7C9B,EAAOkC,kBAAkBnC,IAEvBD,EACFE,EAAOkC,kBAAkBnC,GAEzBC,EAAOG,mBAAmBJ,IAG9BqB,QAvFJ,SAuFA,GAIM,IAHA,IAAIe,EAAI,GACd,IACA,QACaC,EAAIvD,EAAKgC,WAAawB,IAAKD,EAAxC,sEAEM,OADAD,GAAKpB,OAAOC,aAAasB,MAAM,KAAM,IAAI5B,WAAW7B,EAAK0D,MAAMH,EAAIC,KAC5DF,KClIiV,I,wBCQ1VK,EAAY,eACd,EACArE,EACAQ,GACA,EACA,KACA,KACA,MAIa,aAAA6D,E","file":"js/excel.db3931ac.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"excel\"})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"excel\">\n    <!-- 已实现基本功能，此版本为初级版本，后续升级版本均为在本版本基础上升级改造 -->\n    <!-- <el-upload\n      class=\"upload-demo\"\n      action=\"\"\n      :on-change=\"handleChange\"\n      :show-file-list=\"false\"\n      :on-remove=\"handleRemove\"\n      accept=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel\"\n      :auto-upload=\"false\">\n      <el-button size=\"small\" type=\"primary\" >批量上传</el-button>\n      <div slot=\"tip\" class=\"el-upload__tip\">注：只 能 上 传 xlsx / xls 文 件</div>\n    </el-upload>\n    <el-table\n      :data=\"tableData2\"\n      style=\"width: 100%\">\n      <el-table-column prop=\"IP\" label=\"日期\" width=\"180\">\n      </el-table-column>\n      <el-table-column prop=\"NAME\" label=\"姓名\" width=\"180\">\n      </el-table-column>\n      <el-table-column label=\"操作\">\n      </el-table-column>\n    </el-table> -->\n    <!-- :file-list=\"fileListUpload\" -->\n    <!-- :limit=\"limitUpload\" -->\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'excel',\n  data () {\n    return {\n      tableData2: []\n    }\n  },\n  methods: {\n    handelUpload (file) {\n      console.log('file-123123213', file)\n    },\n    // excel表上传\n    handleChange (file, fileList) {\n      this.fileTemp = file.raw\n      console.log('file', file)\n      console.log('fileList', fileList)\n      // 判断上传文件格式\n      if (this.fileTemp) {\n        console.log('this.fileTemp.type', this.fileTemp)\n        // if ((this.fileTemp.type === 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet') || (this.fileTemp.type === 'application/vnd.ms-excel')) {\n        this.importfxx(this.fileTemp)\n        // } else {\n        //   this.$message({\n        //     type: 'warning',\n        //     message: '附件格式错误，请删除后重新上传！'\n        //   })\n        // }\n      } else {\n        this.$message({\n          type: 'warning',\n          message: '请上传附件！'\n        })\n      }\n    },\n    // 移除excel表\n    handleRemove (file, fileList) {\n      this.fileTemp = null\n    },\n    importfxx (obj) {\n      const _this = this\n      // 通过DOM取文件数据\n      this.file = obj\n      var rABS = false // 是否将文件读取为二进制字符串\n      var f = this.file\n      var reader = new FileReader()\n      console.log('reader', reader)\n      FileReader.prototype.readAsBinaryString = function (f) {\n        var binary = ''\n        var rABS = false // 是否将文件读取为二进制字符串\n        // var pt = this\n        var wb // 读取完成的数据\n        var outdata\n        var reader = new FileReader()\n        console.log('reader-1', reader)\n        reader.onload = function (e) {\n          var bytes = new Uint8Array(reader.result)\n          console.log(reader.result)\n          var length = bytes.byteLength\n          for (var i = 0; i < length; i++) {\n            binary += String.fromCharCode(bytes[i])\n          }\n          console.log('binary', binary)\n          var XLSX = require('xlsx')\n          if (rABS) {\n            wb = XLSX.read(btoa(this.fixdata(binary)), { // 手动转化\n              type: 'base64'\n            })\n          } else {\n            wb = XLSX.read(binary, {\n              type: 'binary'\n            })\n          }\n          outdata = XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]])// outdata就是读取excel内容之后输出的东西\n          this.da = [...outdata]\n          const arr = []\n          this.da.map(v => {\n            const obj = {}\n            obj.IP = v.IP // ip是表的标题\n            obj.NAME = v.NAME\n            arr.push(obj)\n          })\n          // return arr\n          console.log('arr', arr)\n          // 把读取的excel表格中的内容放进tableData2中(这里要改成自己的表的名字)\n          _this.tableData2 = _this.tableData2.concat(arr)\n        }\n        reader.readAsArrayBuffer(f)\n      }\n      if (rABS) {\n        reader.readAsArrayBuffer(f)\n      } else {\n        reader.readAsBinaryString(f)\n      }\n    },\n    fixdata (data) { // 文件流转BinaryString\n      var o = ''\n      let l = 0\n      const w = 10240\n      for (; l < data.byteLength / w; ++l) o += String.fromCharCode.apply(null, new Uint8Array(data.slice(l * w, l * w + w)))\n      o += String.fromCharCode.apply(null, new Uint8Array(data.slice(l * w)))\n      return o\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n  .excel {\n\n  }\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=0b1198f0&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}